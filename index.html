<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Othello – PyScript Edition</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- PyScript -->
  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css">
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>

  <py-config>
    packages = ["numpy"]
    [[fetch]]
    files = [
      "./src/__init__.py",
      "./src/game.py",
      "./src/ai.py",
      "./src/ui.py",
      "./src/main.py",
    ]
  </py-config>
</head>
<body>
  <header class="topbar">
    <h1>Othello</h1>
    <div class="badges">
      <span class="badge">PyScript</span>
      <span class="badge">AI</span>
    </div>
  </header>

  <main class="layout">
    <section class="board-wrap">
      <!-- 評価バー（ui.pyに合わせたID） -->
      <div class="evalbar" aria-hidden="true">
        <div id="evalFill"></div>
        <div class="evallabels">
          <div class="label top"><span class="count white" id="whiteCount">2</span></div>
          <div class="label bottom"><span class="count black" id="blackCount">2</span></div>
        </div>
      </div>

      <!-- 盤は ui.py が中に button.cell を生成 -->
      <div class="board-box">
        <div id="board" class="board" role="grid" aria-label="Othello board"></div>

        <!-- オーバーレイ（ui.py が中身を書き換える） -->
        <div id="overlay" class="overlay hidden" aria-live="polite">
          <div class="overlay-card" id="overlayContent"></div>
        </div>
      </div>
    </section>

    <aside class="side">
      <div class="status" id="status">手番：—｜石数 B 2 - W 2｜モード：—</div>

      <div class="card">
        <div class="row">
          <label>モード</label>
          <select id="modeSelect">
            <option value="PVP">2人</option>
            <option value="AI_WHITE" selected>vs AI（白）</option>
            <option value="AI_BLACK">vs AI（黒）</option>
            <option value="AI_VS_AI">AI vs AI</option>
          </select>
        </div>
        <div class="row">
          <label>探索深さ</label>
          <select id="depthSelect">
            <option>1</option><option>2</option><option selected>3</option><option>4</option><option>5</option><option>6</option><option>7</option>
          </select>
        </div>
        <div class="row">
          <label>AI遅延</label>
          <input id="delayRange" type="range" min="0" max="1500" step="50" value="300" />
          <span id="delayValue">300ms</span>
        </div>
        <div class="toggles">
          <label><input type="checkbox" id="hintsToggle" checked> 合法手ハイライト</label>
          <label><input type="checkbox" id="autosaveToggle" checked> 自動保存</label>
        </div>
        <div class="buttons">
          <button id="hintBtn">ヒント</button>
          <button id="passBtn">パス</button>
          <button id="resetBtn" class="danger">リセット</button>
        </div>
      </div>

      <div class="card">
        <strong>着手履歴</strong>
        <ol class="moves" id="movesList"></ol>
        <div class="moves-actions">
          <button id="undoBtn" disabled>戻る</button>
          <button id="redoBtn" disabled>進む</button>
          <button id="copyMovesBtn">コピー</button>
          <button id="clearMovesBtn">クリア</button>
        </div>
      </div>

      <div class="foot">© Othello</div>
    </aside>
  </main>

  <!-- Python 起動 -->
  <py-script src="./src/main.py"></py-script>
</body>
</html>
